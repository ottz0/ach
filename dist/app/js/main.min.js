$(document).on("click","#service-list",function(){$("span#ach-tgl").toggleClass("octicon octicon-chevron-down octicon octicon-chevron-up")}),$(document).on("click",".roominfo",function(){$("span.ach-rmin").toggleClass("octicon octicon-chevron-down octicon octicon-chevron-up")}),$(document).on("click","#room-details",function(){$("span#b-detail").toggleClass("octicon octicon-chevron-down octicon octicon-chevron-up")}),$(document).on("mousedown",".datepicker",function(){var a=new Date,b=new Date(a.getFullYear(),a.getMonth(),a.getDate(),0,0,0,0),c=$("#arrival-date").datepicker({onRender:function(a){return a.valueOf()<b.valueOf()?"disabled":""}}).on("changeDate",function(a){if(a.date.valueOf()>d.date.valueOf()){var b=new Date(a.date);b.setDate(b.getDate()+1),d.setValue(b)}c.hide(),$("#departure-date")[0].focus()}).data("datepicker"),d=$("#departure-date").datepicker({onRender:function(a){return a.valueOf()<=c.date.valueOf()?"disabled":""}}).on("changeDate",function(a){d.hide()}).data("datepicker")}),!function(a){var b=function(b,d){if(this.element=a(b),this.format=c.parseFormat(d.format||this.element.data("date-format")||"mm/dd/yyyy"),this.picker=a(c.template).appendTo("body").on({click:a.proxy(this.click,this)}),this.isInput=this.element.is("input"),this.component=this.element.is(".date")?this.element.find(".add-on"):!1,this.isInput?this.element.on({focus:a.proxy(this.show,this),keyup:a.proxy(this.update,this)}):this.component?this.component.on("click",a.proxy(this.show,this)):this.element.on("click",a.proxy(this.show,this)),this.minViewMode=d.minViewMode||this.element.data("date-minviewmode")||0,"string"==typeof this.minViewMode)switch(this.minViewMode){case"months":this.minViewMode=1;break;case"years":this.minViewMode=2;break;default:this.minViewMode=0}if(this.viewMode=d.viewMode||this.element.data("date-viewmode")||0,"string"==typeof this.viewMode)switch(this.viewMode){case"months":this.viewMode=1;break;case"years":this.viewMode=2;break;default:this.viewMode=0}this.startViewMode=this.viewMode,this.weekStart=d.weekStart||this.element.data("date-weekstart")||0,this.weekEnd=0===this.weekStart?6:this.weekStart-1,this.onRender=d.onRender,this.fillDow(),this.fillMonths(),this.update(),this.showMode()};b.prototype={constructor:b,show:function(b){this.picker.show(),this.height=this.component?this.component.outerHeight():this.element.outerHeight(),this.place(),a(window).on("resize",a.proxy(this.place,this)),b&&(b.stopPropagation(),b.preventDefault()),!this.isInput;var c=this;a(document).on("mousedown",function(b){0==a(b.target).closest(".datepicker").length&&c.hide()}),this.element.trigger({type:"show",date:this.date})},hide:function(){this.picker.hide(),a(window).off("resize",this.place),this.viewMode=this.startViewMode,this.showMode(),this.isInput||a(document).off("mousedown",this.hide),this.element.trigger({type:"hide",date:this.date})},set:function(){var a=c.formatDate(this.date,this.format);this.isInput?this.element.prop("value",a):(this.component&&this.element.find("input").prop("value",a),this.element.data("date",a))},setValue:function(a){"string"==typeof a?this.date=c.parseDate(a,this.format):this.date=new Date(a),this.set(),this.viewDate=new Date(this.date.getFullYear(),this.date.getMonth(),1,0,0,0,0),this.fill()},place:function(){var a=this.component?this.component.offset():this.element.offset();this.picker.css({top:a.top+this.height,left:a.left})},update:function(a){this.date=c.parseDate("string"==typeof a?a:this.isInput?this.element.prop("value"):this.element.data("date"),this.format),this.viewDate=new Date(this.date.getFullYear(),this.date.getMonth(),1,0,0,0,0),this.fill()},fillDow:function(){for(var a=this.weekStart,b="<tr>";a<this.weekStart+7;)b+='<th class="dow">'+c.dates.daysMin[a++%7]+"</th>";b+="</tr>",this.picker.find(".datepicker-days thead").append(b)},fillMonths:function(){for(var a="",b=0;12>b;)a+='<span class="month">'+c.dates.monthsShort[b++]+"</span>";this.picker.find(".datepicker-months td").append(a)},fill:function(){var a=new Date(this.viewDate),b=a.getFullYear(),d=a.getMonth(),e=this.date.valueOf();this.picker.find(".datepicker-days th:eq(1)").text(c.dates.months[d]+" "+b);var f=new Date(b,d-1,28,0,0,0,0),g=c.getDaysInMonth(f.getFullYear(),f.getMonth());f.setDate(g),f.setDate(g-(f.getDay()-this.weekStart+7)%7);var h=new Date(f);h.setDate(h.getDate()+42),h=h.valueOf();for(var i,j,k,l=[];f.valueOf()<h;)f.getDay()===this.weekStart&&l.push("<tr>"),i=this.onRender(f),j=f.getFullYear(),k=f.getMonth(),d>k&&j===b||b>j?i+=" old":(k>d&&j===b||j>b)&&(i+=" new"),f.valueOf()===e&&(i+=" active"),l.push('<td class="day '+i+'">'+f.getDate()+"</td>"),f.getDay()===this.weekEnd&&l.push("</tr>"),f.setDate(f.getDate()+1);this.picker.find(".datepicker-days tbody").empty().append(l.join(""));var m=this.date.getFullYear(),n=this.picker.find(".datepicker-months").find("th:eq(1)").text(b).end().find("span").removeClass("active");m===b&&n.eq(this.date.getMonth()).addClass("active"),l="",b=10*parseInt(b/10,10);var o=this.picker.find(".datepicker-years").find("th:eq(1)").text(b+"-"+(b+9)).end().find("td");b-=1;for(var p=-1;11>p;p++)l+='<span class="year'+(-1===p||10===p?" old":"")+(m===b?" active":"")+'">'+b+"</span>",b+=1;o.html(l)},click:function(b){b.stopPropagation(),b.preventDefault();var d=a(b.target).closest("span, td, th");if(1===d.length)switch(d[0].nodeName.toLowerCase()){case"th":switch(d[0].className){case"switch":this.showMode(1);break;case"prev":case"next":this.viewDate["set"+c.modes[this.viewMode].navFnc].call(this.viewDate,this.viewDate["get"+c.modes[this.viewMode].navFnc].call(this.viewDate)+c.modes[this.viewMode].navStep*("prev"===d[0].className?-1:1)),this.fill(),this.set()}break;case"span":if(d.is(".month")){var e=d.parent().find("span").index(d);this.viewDate.setMonth(e)}else{var f=parseInt(d.text(),10)||0;this.viewDate.setFullYear(f)}0!==this.viewMode&&(this.date=new Date(this.viewDate),this.element.trigger({type:"changeDate",date:this.date,viewMode:c.modes[this.viewMode].clsName})),this.showMode(-1),this.fill(),this.set();break;case"td":if(d.is(".day")&&!d.is(".disabled")){var g=parseInt(d.text(),10)||1,e=this.viewDate.getMonth();d.is(".old")?e-=1:d.is(".new")&&(e+=1);var f=this.viewDate.getFullYear();this.date=new Date(f,e,g,0,0,0,0),this.viewDate=new Date(f,e,Math.min(28,g),0,0,0,0),this.fill(),this.set(),this.element.trigger({type:"changeDate",date:this.date,viewMode:c.modes[this.viewMode].clsName})}}},mousedown:function(a){a.stopPropagation(),a.preventDefault()},showMode:function(a){a&&(this.viewMode=Math.max(this.minViewMode,Math.min(2,this.viewMode+a))),this.picker.find(">div").hide().filter(".datepicker-"+c.modes[this.viewMode].clsName).show()}},a.fn.datepicker=function(c,d){return this.each(function(){var e=a(this),f=e.data("datepicker"),g="object"==typeof c&&c;f||e.data("datepicker",f=new b(this,a.extend({},a.fn.datepicker.defaults,g))),"string"==typeof c&&f[c](d)})},a.fn.datepicker.defaults={onRender:function(a){return""}},a.fn.datepicker.Constructor=b;var c={modes:[{clsName:"days",navFnc:"Month",navStep:1},{clsName:"months",navFnc:"FullYear",navStep:1},{clsName:"years",navFnc:"FullYear",navStep:10}],dates:{days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],daysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat","Sun"],daysMin:["Su","Mo","Tu","We","Th","Fr","Sa","Su"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],monthsShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]},isLeapYear:function(a){return a%4===0&&a%100!==0||a%400===0},getDaysInMonth:function(a,b){return[31,c.isLeapYear(a)?29:28,31,30,31,30,31,31,30,31,30,31][b]},parseFormat:function(a){var b=a.match(/[.\/\-\s].*?/),c=a.split(/\W+/);if(!b||!c||0===c.length)throw new Error("Invalid date format.");return{separator:b,parts:c}},parseDate:function(a,b){var c,d=a.split(b.separator),a=new Date;if(a.setHours(0),a.setMinutes(0),a.setSeconds(0),a.setMilliseconds(0),d.length===b.parts.length){for(var e=a.getFullYear(),f=a.getDate(),g=a.getMonth(),h=0,i=b.parts.length;i>h;h++)switch(c=parseInt(d[h],10)||1,b.parts[h]){case"dd":case"d":f=c,a.setDate(c);break;case"mm":case"m":g=c-1,a.setMonth(c-1);break;case"yy":e=2e3+c,a.setFullYear(2e3+c);break;case"yyyy":e=c,a.setFullYear(c)}a=new Date(e,g,f,0,0,0)}return a},formatDate:function(a,b){var c={d:a.getDate(),m:a.getMonth()+1,yy:a.getFullYear().toString().substring(2),yyyy:a.getFullYear()};c.dd=(c.d<10?"0":"")+c.d,c.mm=(c.m<10?"0":"")+c.m;for(var a=[],d=0,e=b.parts.length;e>d;d++)a.push(c[b.parts[d]]);return a.join(b.separator)},headTemplate:'<thead><tr><th class="prev">&lsaquo;</th><th colspan="5" class="switch"></th><th class="next">&rsaquo;</th></tr></thead>',contTemplate:'<tbody><tr><td colspan="7"></td></tr></tbody>'};c.template='<div class="datepicker dropdown-menu"><div class="datepicker-days"><table class=" table-condensed">'+c.headTemplate+'<tbody></tbody></table></div><div class="datepicker-months"><table class="table-condensed">'+c.headTemplate+c.contTemplate+'</table></div><div class="datepicker-years"><table class="table-condensed">'+c.headTemplate+c.contTemplate+"</table></div></div>"}(window.jQuery),$(document).ready(function(){function a(){var a={types:["(cities)"]};input=document.getElementById("destination-home"),input=document.getElementById("destination"),autocomplete=new google.maps.places.Autocomplete(input,a)}google.maps.event.addDomListener(window,"load",a)}),angular.module("achApp").constant("APP_SETTINGS",{APP_NAME:"Ach Application",VERSION:"1.0"}),function(){var a=function(a,b,c,d,e){a.globalVars=function(){a.globalData={showSearchBar:!0},a.$on("$stateChangeStart",function(b,c,d){a.globalData.showSearchBar=!0})},a.globalVars(),a.achSearchForm=function(){$storage=sessionStorage,a.achSearch={};var b=function(){a.achSearch={},a.achSearch.numberOfAdults="2",a.achSearch.numberOfChildren="0",a.achSearch.childAges={}},c=function(){a.achSearch.childAges={},a.achSearch.childAges.child1="1",a.achSearch.childAges.child2="1",a.achSearch.childAges.child3="1",a.achSearch.childAges.child4="1"};c(),null===sessionStorage.getItem("achSearch")?b():a.achSearch=JSON.parse($storage.achSearch),a.updateChildren=function(){var b=a.achSearch.numberOfChildren;"0"==b?(a.child1=!1,a.child2=!1,a.child3=!1,a.child4=!1,c()):"1"==b?(a.child1=!0,a.child2=!1,a.child3=!1,a.child4=!1):"2"==b?(a.child1=!0,a.child2=!0,a.child3=!1,a.child4=!1):"3"==b?(a.child1=!0,a.child2=!0,a.child3=!0,a.child4=!1):"4"==b&&(a.child1=!0,a.child2=!0,a.child3=!0,a.child4=!0)},a.updateChildren()},a.achSearchForm(),a.gc.setSearchDestination=function(){var b={},c=$("#arrival-date").val(),d=$("#departure-date").val(),e=$("#destination").val(),g={destination:e,arrivalDate:c,departureDate:d,numberOfAdults:a.achSearch.numberOfAdults,numberOfChildren:a.achSearch.numberOfChildren};return g.childAges={},g.childAges=b,0==a.achSearch.numberOfChildren?delete g.childAges:1==a.achSearch.numberOfChildren?g.childAges.child1=a.achSearch.childAges.child1:2==a.achSearch.numberOfChildren?(g.childAges.child1=a.achSearch.childAges.child1,g.childAges.child2=a.achSearch.childAges.child2):3==a.achSearch.numberOfChildren?(g.childAges.child1=a.achSearch.childAges.child1,g.childAges.child2=a.achSearch.childAges.child2,g.childAges.child3=a.achSearch.childAges.child3):4==a.achSearch.numberOfChildren&&(g.childAges.child1=a.achSearch.childAges.child1,g.childAges.child2=a.achSearch.childAges.child2,g.childAges.child3=a.achSearch.childAges.child3,g.childAges.child4=a.achSearch.childAges.child4),$storage.achSearch=JSON.stringify(g),f()};var f=function(){a.gethotelsFactory=e,a.gethotelsFactory.searchRequest(),"/hotels"===b.path()?location.reload():"hotel"===c.current.name?location.reload():b.path("/hotels")}};a.$inject=["$scope","$location","$state","$sessionStorage","hotelsFactory"],angular.module("achApp").controller("globalController",a).directive("scrollToItem",function(){return{restrict:"A",scope:{scrollTo:"@"},link:function(a,b,c){b.on("click",function(){$("html,body").animate({scrollTop:$(a.scrollTo).offset().top},"slow")})}}}).directive("backButton",function(){return{restrict:"A",link:function(a,b,c){b.on("click",function(){history.back(),a.$apply()})}}}).directive("dateNow",["$filter",function(a){return{link:function(b,c,d){c.text(a("date")(new Date,d.dateNow))}}}])}(),function(){var a=function(a){var b={};return $storage=sessionStorage,b.getHotelListRequest=function(){var a=$("#destination").val(),b=$("#arrival-date").val(),c=$("#departure-date").val(),d=$("#adults").val(),e=$("#children").val(),f={destination:a,arrivalDate:b,departureDate:c,numberOfAdults:d,numberOfChildren:e,childAges:childAges};return console.log(f)},b.setSearchSession=function(a){return $storage.achSearch=JSON.stringify(a)},b};angular.module("achApp").factory("searchFactory",a)}(),function(){var a=function(){var a={};return a.dateStr=function(a){var a=a;return a=a.substr(3,2)+"/"+a.substr(0,2)+"/"+a.substr(6,4)},a};angular.module("achApp").factory("dateFactory",a)}(),function(){var a=function(){var a={};return a.getHotelRating=function(a){switch(a){case 5:a="assets/img/stars_5.gif";break;case 4.5:a="assets/img/stars_4_5.gif";break;case 4:a="assets/img/stars_4.gif";break;case 3.5:a="assets/img/stars_3_5.gif";break;case 3:a="assets/img/stars_3.gif";break;case 2.5:a="assets/img/stars_2_5.gif";break;case 2:a="assets/img/stars_2.gif";break;case 1.5:a="assets/img/stars_1_5.gif";break;case 1:a="assets/img/stars_1.gif";break;default:a="assets/img/stars_none.gif"}return dataHotelRating=a},a};angular.module("achApp").factory("hotelRatingFactory",a)}(),function(){var a=function(a){var b={};return $storage=sessionStorage,b.getSearchSession=function(){return achSearch=JSON.parse($storage.achSearch)},b};angular.module("achApp").factory("searchSessionFactory",a)}(),function(){var a=function(){var a={};return a.getAusStates=function(a){switch(a){case"AC":a="ACT";break;case"NW":a="NSW";break;case"NO":a="NT";break;case"QL":a="QLD";break;case"SA":a="SA";break;case"TS":a="TAS";break;case"VC":a="VIC";break;case"WT":a="WA"}return dataState=a},a};angular.module("achApp").factory("stateFactory",a)}(),function(){var a=function(a,b,c,d){var e={};return e.dateFactory=function(b){var b=b;return a.dateStr(b)},e.getSearchSession=function(){return b.getSearchSession()},e.changeStates=function(a){return c.getAusStates(a)},e.changeRating=function(a){return d.getHotelRating(a)},e.myTestResponse=function(){return{FirstName:""}},e};angular.module("achApp").factory("utilsFactory",a)}(),function(){var a=function(a,b,c,d,e,f){a.eanErrorBlock=!1,a.eanConfirmBlock=!1,a.achMain=!0,a.loading=!0,a.achBookingHeader=!0,$storage=sessionStorage,a.hotelInformation=JSON.parse($storage.achHotelInformation),a.roomDetails=JSON.parse($storage.achRoomDetails),a.moreResults=JSON.parse($storage.achMoreResults),a.achSearch=JSON.parse($storage.achSearch),a.roomPrices=a.roomDetails.RateInfos.RateInfo.ChargeableRateInfo;var f=f.newGuid();a.disableButtons=!0,a.ReservationInfo={country:"AU"},a.months=["01","02","03","04","05","06","07","08","09","10","11","12"],a.years=["2016","2017","2018","2019","2020","2021","2022","2023","2024","2025","2026"],function(){b.get("assets/json/countryCodes.json").then(function(a){angular.fromJson(a)})}(),function(){var b=a.roomPrices.NightlyRatesPerRoom["@size"];1==b?a.nightPrice=!0:a.nightPriceMulti=!0}(),a.bookingForm=function(){a.guid=f;var b={},b=a.ReservationInfo;b.affiliateConfirmationId=f,a.testForm=b,d.getBookingInformation(b).then(function(b){var c=b.HotelRoomReservationResponse;c.EanWsError?(console.log("Its an error"),a.eanError(c)):a.bookingConfirm(c)})},a.bookingConfirm=function(b){a.HotelRoomReservationResponse=b,console.log(a.HotelRoomReservationResponse),a.eanConfirmBlock=!0,a.achBookingHeader=!1,a.achMain=!1},a.eanError=function(b){a.eanError=b.EanWsError,a.eanErrorBlock=!0,a.achMain=!1,console.log(b)}};a.$inject=["$scope","$http","$location","bookFactory","$sessionStorage","Guid"],angular.module("achApp").controller("BookController",a)}(),function(){var a=function(a,b,c,d,e){var f={};return f.getBookingInformation=function(a){var b=(sessionStorage,JSON.parse($storage.achHotelInformation)),d=JSON.parse($storage.achRoomDetails),g=JSON.parse($storage.achMoreResults),h=JSON.parse($storage.achSearch),i=e.dateFactory(h.arrivalDate),j=e.dateFactory(h.departureDate),k=h.numberOfChildren,l=h.childAges,m=h.numberOfAdults,n=[];if(angular.forEach(l,function(a){n.push(parseInt(a))}),k>0)var m=h.numberOfAdults+","+n;var o={customerSessionId:g.customerSessionId,hotelId:b.hotelId,arrivalDate:i,departureDate:j,supplierType:d.supplierType,rateKey:d.RateInfos.RateInfo.RoomGroup.Room.rateKey,roomTypeCode:d.RoomType["@roomCode"],rateCode:d.rateCode,room1:m,bedTypeId:d.BedTypes.BedType["@id"],smokingPreference:d.smokingPreferences,chargeableRate:d.RateInfos.RateInfo.ChargeableRateInfo["@total"]},p={room1FirstName:a.room1FirstName,room1LastName:a.room1LastName,email:a.email,firstName:a.firstName,lastName:a.lastName,homePhone:a.homePhone,creditCardType:a.creditCardType,creditCardNumber:a.creditCardNumber,creditCardIdentifier:a.creditCardIdentifier,creditCardExpirationMonth:a.creditCardExpirationMonth,creditCardExpirationYear:a.creditCardExpirationYear,address1:a.address1,city:a.city,stateProvinceCode:a.stateProvinceCode,countryCode:"AU",postalCode:a.postalCode,affiliateConfirmationId:a.affiliateConfirmationId},q=c(o)+"&"+c(p);return f.eanApiBookingRequest(q)},f.eanApiBookingRequest=function(b){return a({method:"post",url:"eanapi/ean-api-book.php",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:b}).then(function(a){return a.data})},f};a.$inject=["$http","$stateParams","$httpParamSerializer","$sessionStorage","utilsFactory"],angular.module("achApp").factory("bookFactory",a)}(),function(){var a=function(a,b){a.isActive=function(a){return a===b.path()}};a.$inject=["$scope","$location"],angular.module("achApp").controller("NavController",a)}(),function(){var a=function(a){};a.$inject=["$scope"],angular.module("achApp").controller("DevController",a)}(),function(){var a=function(){};angular.module("achApp").factory("devFactory",a)}(),function(){var a=function(a){};a.$inject=["$scope"],angular.module("achApp").controller("DevaController",a)}(),function(){var a=function(a){var b={};return b.myTest=function(){return a({method:"GET",url:"https://api.ipify.orgv?format=json"})},b};angular.module("achApp").factory("devaFactory",a)}(),function(){var a=function(a,b){};a.$inject=["$scope","utilsFactory"],angular.module("achApp").controller("DevbController",a)}(),function(){var a=function(a,b){};a.$inject=["$scope","$state"],angular.module("achApp").controller("HomeController",a)}(),function(){var a=function(a,b,c,d,e,f,g,h){a.loading=!0,$storage=sessionStorage,a.achSearch=JSON.parse($storage.achSearch),a.getHotelInformation=function(){e.getHotelInformation().then(function(b){var c=b.HotelInformationResponse;a.hotelDetails=b.HotelInformationResponse.HotelDetails,a.images=b.HotelInformationResponse.HotelImages.HotelImage,a.hotel=b.HotelInformationResponse.HotelSummary,a.trustedHtml=function(a){return h.trustAsHtml(a)};var c=b.HotelInformationResponse.HotelSummary;!function(){var b=c.stateProvinceCode;return f.changeStates(b),a.hotel.stateProvinceCode=dataState}(),function(){var b=c.hotelRating;return f.changeRating(b),a.hotel.hotelRating=dataHotelRating}(),a.currentImage=a.images[0],a.setCurrentImage=function(b){a.currentImage=b},a.googleMap=function(){d(function(){g.getMap().then(function(b){google.maps.event.trigger(b,"resize"),a.achLat=c.latitude,a.achLong=c.longitude})},500)}})},a.getHotelInformation(),a.hotelRoomAvailability=function(){e.hotelRoomAvailability().then(function(b){a.roomRateData=b.HotelRoomAvailabilityResponse.HotelRoomResponse,a.availResp=b.HotelRoomAvailabilityResponse,a.roomRateData.RateInfos?(a.lowestPrice=b.HotelRoomAvailabilityResponse.HotelRoomResponse.RateInfos.RateInfo.ChargeableRateInfo["@total"],a.snglRoom=!0):(a.lowestPrice=b.HotelRoomAvailabilityResponse.HotelRoomResponse[0].RateInfos.RateInfo.ChargeableRateInfo["@total"],a.multiRoom=!0),a.loading=!1})},a.hotelRoomAvailability(),a.setHotelBookingDetails=function(a,b){return e.setHotelBookingDetails(a,b)}};a.$inject=["$scope","$stateParams","$sessionStorage","$timeout","hotelFactory","utilsFactory","NgMap","$sce"],angular.module("achApp").controller("HotelController",a)}(),function(){var a=function(a,b,c,d,e){var f={};$storage=sessionStorage;var g=c.hotelId;return f.getHotelInformation=function(){var a="http://api.ean.com/ean-services/rs/hotel/v3/info?hotelId="+g+"&options=DEFAULT";return f.eanApiRequest(a)},f.hotelRoomAvailability=function(){var a=JSON.parse($storage.achSearch),b=JSON.parse($storage.achMoreResults),c=a.numberOfChildren,d=a.childAges,h=a.numberOfAdults,i=[];if(angular.forEach(d,function(a){i.push(parseInt(a))}),c>0)var h=a.numberOfAdults+","+i;var j=e.dateFactory(a.arrivalDate),k=e.dateFactory(a.departureDate),l=(encodeURIComponent(a.destination),"http://api.ean.com/ean-services/rs/hotel/v3/avail?hotelId="+g+"&arrivalDate="+j+"&departureDate="+k+"&room1="+h+"&includeRoomImages=true&customerSessionId="+b.customerSessionId+"&options=ROOM_TYPES,ROOM_AMENITIES");return f.eanApiRequest(l)},f.setHotelBookingDetails=function(a,c){$storage.achHotelInformation=JSON.stringify(c),$storage.achRoomDetails=JSON.stringify(a),b.path("/book")},f.eanApiRequest=function(b){return a({method:"post",url:"eanapi/ean-api.php",data:b}).then(function(a){return a.data})},f};a.$inject=["$http","$location","$stateParams","$sessionStorage","utilsFactory"],angular.module("achApp").factory("hotelFactory",a)}(),function(){var a=function(a,b,c,d,e,f,g,h,i){a.eanErrorBlock=!1,a.loading=!0,a.getEanApi=function(){a.loading=!0,f.searchRequest().then(function(b){a.displayResults(b)})},a.getEanApi(),a.moreResults=function(){a.moreResSpin=!0,f.moreResults().then(function(b){var c=b.HotelListResponse.HotelList;if(c){var d=b.HotelListResponse.HotelList.HotelSummary;a.hotels=a.hotels.concat(d),a.moreResSpin=!1}else a.eanError(b)})},a.subPreloadActive=function(){console.log("hiot"),a.subPreload=!0,e(function(){a.subPreload=!1},1250)},a.displayResults=function(b){var c=b.HotelListResponse.HotelList;c?(a.achMain=!0,a.HotelListResponse=b.HotelListResponse,a.hotels=b.HotelListResponse.HotelList.HotelSummary,a.achSearch=JSON.parse($storage.achSearch)):a.eanError(b),e(function(){a.loading=!1},2e3)},a.eanError=function(b){var c=b.HotelListResponse.EanWsError;return a.achMain=!1,"RESULT_NULL"!==c.category?(a.eanError=c,console.log(c),a.eanErrorBlock=!0):void(a.moreResults=!1)}};a.$inject=["$scope","$stateParams","$location","$sessionStorage","$timeout","hotelsFactory","utilsFactory","spinnerService","Slug"],angular.module("achApp").controller("HotelsController",a)}(),function(){var a=function(a,b,c){var d={};return $storage=sessionStorage,d.searchRequest=function(){var a=JSON.parse($storage.achSearch),b=a.numberOfChildren,e=a.childAges,f=a.numberOfAdults,g=[];if(angular.forEach(e,function(a){g.push(parseInt(a))}),b>0)var f=a.numberOfAdults+","+g;var h=c.dateFactory(a.arrivalDate),i=c.dateFactory(a.departureDate),j=encodeURIComponent(a.destination),k="http://api.ean.com/ean-services/rs/hotel/v3/list?destinationString="+j+"&arrivalDate="+h+"&departureDate="+i+"&room1="+f+"&options=DEFAULT&numberOfResults=10";return d.eanApiRequest(k)},d.moreResults=function(){var a=JSON.parse($storage.achMoreResults),b="http://api.ean.com/ean-services/rs/hotel/v3/list?cacheKey="+a.cacheKey+"&cacheLocation="+a.cacheLocation;return d.eanApiRequest(b)},d.eanApiRequest=function(b){return a({method:"post",url:"eanapi/ean-api.php",data:b}).then(function(a){var b=a.data,d=b.HotelListResponse;return d.HotelList?(b.hotels=b.HotelListResponse.HotelList.HotelSummary,function(){angular.forEach(b.hotels,function(a,b){var d=a.stateProvinceCode;return c.changeStates(d),a.stateProvinceCode=dataState})}(),function(){angular.forEach(b.hotels,function(a,b){var d=a.hotelRating;return c.changeRating(d),a.hotelRating=dataHotelRating})}(),function(){var b=a.data.HotelListResponse,c={cacheKey:b.cacheKey,cacheLocation:b.cacheLocation,customerSessionId:b.cacheLocation};$storage.achMoreResults=JSON.stringify(c)}(),a.data):b})},d};a.$inject=["$http","$sessionStorage","utilsFactory"],angular.module("achApp").factory("hotelsFactory",a)}();